<?php
include("php-1.11/geoipcity.inc");
include("php-1.11/geoipregionvars.php");

	$listeIP=Array($_SERVER['REMOTE_ADDR'],'78.186.195.68','122.52.229.113','59.126.203.191','106.92.74.192','110.202.224.21','109.184.29.239','61.153.36.246','78.110.65.4','188.125.60.249','220.73.127.44','61.142.165.165','60.174.242.191','113.139.198.240','171.48.54.247','36.39.237.16','46.98.158.2','189.159.59.201','113.105.195.129','186.216.195.156','200.61.32.83','115.87.214.79','91.151.229.40','189.139.99.64','41.253.63.98','117.25.68.164','112.187.30.240','58.10.87.128','186.149.237.6','114.223.54.141','121.184.237.188','168.128.6.224','120.10.245.174','183.101.120.173','198.245.103.122','77.254.99.7','120.61.14.159','1.189.241.239','190.79.246.231','119.42.106.210','117.94.225.78','187.57.121.94','81.248.206.85','5.239.167.211','212.14.198.144','88.247.205.227','1.226.159.112','114.33.254.215','187.160.37.90','124.230.13.77','95.70.197.3','61.52.192.175','119.93.21.2','89.216.123.157','176.33.181.182','59.95.37.65','111.206.95.249','182.186.137.180','189.103.176.177','5.154.55.234','88.249.164.67','87.223.108.49','179.197.129.64','2.180.17.250','58.220.199.62','114.198.79.159','181.118.199.212','14.169.115.16','181.74.72.176','171.88.133.39','190.171.221.28','186.107.138.142','182.87.225.122','108.14.182.226','117.123.84.30','181.42.167.25','178.221.55.128','203.232.69.140','65.182.72.245','5.138.65.102','14.175.234.226','123.241.240.253','91.211.205.252','122.88.158.58','78.23.25.103','27.106.72.202','62.0.98.107','88.250.233.181','201.192.39.190','41.253.62.74','104.245.103.122','211.59.1.18','41.41.111.230','61.7.135.236','190.186.237.116','218.144.228.120','116.107.26.97','50.113.246.14','192.228.172.120','175.199.161.230','113.207.91.20','117.220.39.126','27.1.108.101','50.67.14.167','177.157.160.52','152.173.58.108','39.187.198.130','181.162.46.241','59.63.59.105','36.81.118.206','84.91.209.235','117.192.254.63','202.142.92.252','115.79.154.137','87.121.76.98','189.234.137.137','113.236.87.173','92.169.138.212','220.134.225.176','187.62.22.98','190.73.122.120','122.117.253.161','187.185.124.226','119.164.34.28','210.6.194.216','122.170.150.67','110.36.176.60','113.71.155.113','187.207.112.215','80.13.164.167','118.69.142.72','116.73.211.126','84.0.192.56','171.232.127.143','113.163.242.26','187.212.70.1','181.143.101.59','220.124.241.224','88.250.229.115','81.97.88.217','187.152.80.176','115.40.216.228','122.117.203.144','190.249.19.208','118.69.136.133','202.153.226.50','179.127.64.39','60.244.70.99','78.189.217.222','178.156.182.194','42.112.60.62','93.91.113.133','78.184.224.63','77.110.26.154','121.224.160.112','201.143.96.196','78.186.241.193','190.165.177.196','223.80.241.252','187.245.218.21','190.31.205.243','37.34.184.92','85.67.85.167','190.141.155.194','189.89.11.151','74.213.89.9','85.99.121.142','122.242.179.60','222.254.90.82','118.233.195.204','58.209.243.18','59.152.58.40','93.170.158.99','73.18.165.81','190.209.125.166','186.206.36.69','59.126.58.181','121.239.206.163','119.52.174.151','120.1.114.217','210.97.120.220','58.182.79.159','180.215.231.107','75.147.0.190','93.39.201.123','85.99.110.82','220.158.138.175','78.189.185.46','85.98.21.140','82.102.231.231','187.250.222.212','185.6.248.68','121.172.145.95','221.228.131.170','59.99.249.143','190.165.94.20','90.63.185.110','84.117.218.205','59.56.226.153','175.106.51.142','183.55.121.190','12.205.168.210','116.72.103.45','190.30.113.57','49.206.128.42','181.197.60.112','211.72.198.45','189.249.64.21','188.237.207.5','42.112.99.7','115.134.218.16','186.12.231.98','78.89.184.193','122.54.217.11','95.251.180.116','77.45.159.103','1.186.226.67','60.4.199.149','121.149.180.70','124.104.248.41','78.187.73.34','206.217.96.232','138.19.6.29','189.129.205.34','83.26.105.49','14.188.31.84','114.34.202.54','209.152.87.101','186.117.133.156','220.133.221.247','58.30.52.41','114.246.210.153','180.189.111.196','176.107.254.214','200.119.201.43','14.169.123.147','14.185.167.54','189.152.187.91','117.3.194.208','202.100.99.194','181.111.242.243','58.242.233.211','78.186.246.157','43.242.227.65','171.220.176.249','182.180.99.229','183.33.124.91','181.164.202.241','186.105.144.233','59.126.240.86','159.205.217.136','190.29.180.142','42.115.189.118','211.76.80.87','193.106.194.110','49.206.192.117','74.65.233.6','213.22.116.216','14.96.174.240','177.205.219.205','117.92.150.203','108.50.155.204','81.30.120.21','109.203.179.192','88.247.131.124','220.158.156.58','95.105.5.48','95.32.66.131','41.32.52.248','189.166.74.64','187.65.124.220','181.143.210.58','169.0.223.62','182.203.106.82','212.156.223.245','80.178.219.105','84.5.146.164','213.14.181.67','79.54.115.229','14.164.88.109','77.45.220.131','117.199.234.251','200.118.196.11','94.240.162.108','187.123.176.232','182.242.90.199','94.248.212.186','217.13.219.146','179.190.217.122','93.222.136.129','183.24.245.234','61.90.37.0','201.199.94.123','124.121.63.123','14.186.147.34','190.231.147.144','189.150.3.169','123.141.192.99','101.185.31.75','183.9.185.7','80.8.147.94','27.119.166.197','211.21.104.80','41.225.215.96','95.12.72.74','122.191.123.98','122.191.204.35','76.19.95.135','162.217.212.38','88.247.92.149','189.172.167.73','124.244.212.36','5.172.86.183','200.82.150.204','183.48.232.174','191.5.246.1','93.119.203.30','59.126.150.127','186.120.208.131','59.127.162.90','31.168.201.125','89.154.126.209','2.179.160.50','101.18.41.9','177.158.180.149','197.149.28.153','186.117.248.91','78.33.185.124','14.187.160.177','195.80.140.249','93.140.85.158','101.25.160.248','220.126.175.28','74.92.43.185','59.98.108.162','80.14.21.110','14.183.84.80','39.75.249.236','93.118.249.136','187.156.224.114','1.34.83.159','178.221.254.79','223.244.184.54','46.43.78.85','14.148.236.83','90.36.248.30','121.140.202.118','59.98.255.60','201.241.212.51','88.247.122.235','104.219.234.66','41.100.54.138','121.8.167.7','113.174.253.6','123.110.185.250','186.113.186.54','101.83.139.34','181.58.124.160','203.128.195.127','188.18.110.8','112.109.244.55','37.202.94.74','152.240.48.91','59.93.163.100','201.233.99.22','88.148.34.76','181.29.215.86','14.111.118.152','190.160.104.208','106.90.201.46','1.52.208.59','201.52.202.209','114.233.150.57','59.35.252.233','91.211.135.117','110.143.128.249','220.135.211.17','191.255.184.109','113.180.87.245','178.212.194.4','116.7.88.213','31.168.215.147','112.134.180.242','112.211.54.17','14.175.232.161','36.78.83.105','125.78.61.80','47.18.195.185','186.19.63.243','88.247.180.184','181.225.65.36','120.34.180.34','91.98.113.53','85.155.162.13','119.75.161.200','115.79.96.179','116.127.11.112','177.42.224.158','213.129.54.68','114.35.95.221','43.252.221.57','45.72.147.30','110.169.14.33','190.192.229.13','106.122.195.18','210.78.141.238','112.161.217.118','114.32.239.102','220.134.179.196','189.234.128.104','118.100.202.86','113.170.193.29','60.248.117.134','176.49.156.252','197.0.248.228','45.127.53.211','176.33.181.118','189.41.161.114','151.250.94.155','122.175.227.215','211.38.57.197','113.248.39.109','89.41.170.15','88.249.184.29','122.173.155.180','190.73.169.192','181.75.222.185','114.33.249.124','59.173.187.207','75.99.147.178','190.67.173.217','82.36.86.64','113.72.182.225','209.152.87.124','183.32.135.70','186.96.194.126','188.136.251.100','94.45.209.13','187.211.16.48','186.12.231.178','95.17.44.189','37.54.221.180','213.118.90.218','182.188.39.184','189.218.125.31','88.80.47.57','41.32.15.195','103.51.217.191','201.27.202.218','183.49.29.110','211.22.244.86','223.78.90.196','200.82.145.26','124.66.26.138','92.167.242.8','179.40.202.192','189.130.65.205','111.35.135.179','219.85.184.241','14.148.161.127','82.240.89.31','80.8.170.99','212.5.200.145','49.207.179.90','124.219.250.86','183.81.2.118','125.39.30.184','93.114.247.16','121.150.103.102','118.232.196.165','190.190.239.175','223.115.146.183','113.183.151.118','109.168.246.130','66.146.226.23','123.241.241.1','119.93.85.214','98.200.110.28','59.89.236.29','186.212.74.100','211.10.182.46','27.211.51.183','116.106.253.173','31.163.36.229','189.205.177.139','14.114.250.17','63.229.132.178','122.116.209.107','117.218.250.157','186.223.209.193','187.160.195.121','151.27.70.154','203.192.201.25','123.194.244.24','88.248.192.253','211.36.146.252','41.225.198.91','36.78.223.47','111.182.10.234','119.126.78.71','187.2.10.200','87.28.163.9','88.249.124.25','64.66.21.186','183.9.66.13','188.237.37.237','116.104.9.109','123.13.50.2','116.18.169.235','190.108.216.80','69.207.82.113','190.147.213.78','36.85.51.184','78.186.130.19','119.153.103.197','117.218.189.59','14.162.73.126','43.241.125.144','176.214.37.127','115.224.64.174','14.175.166.18','2.62.33.136','117.239.51.156','220.165.195.168','220.133.51.127','123.180.117.140','113.240.129.221','125.39.8.232','116.107.71.180','182.58.3.28','39.73.249.27','79.16.227.24','185.145.186.77','123.160.201.255','59.127.133.162','179.37.35.2','119.93.245.123','186.79.133.1','59.177.121.69','78.186.159.132','189.78.193.28','189.190.17.136','46.17.121.73','42.117.83.144','122.54.221.177','101.20.90.212','182.186.8.151','79.68.149.158','46.45.227.2','81.172.32.177','182.99.61.24','183.9.7.149','61.2.59.159','189.153.80.188','45.120.252.89','220.134.180.218','77.42.242.116','98.112.90.121','5.19.170.202','183.8.98.52','27.106.2.1','84.92.67.145','41.152.184.166','201.17.191.250','179.183.145.157','210.187.0.53','120.219.15.57','14.161.35.70','113.103.229.146','180.189.105.162','119.118.47.146','123.176.13.146','31.11.113.3','89.145.144.192','109.62.181.123','110.167.76.12','108.27.217.136','180.253.125.86','125.112.102.93','41.38.234.102','201.81.195.174','96.44.32.29','46.185.109.239','190.1.172.11','113.163.248.210','218.63.236.107','177.230.233.132','113.84.55.185','123.194.113.239','75.43.70.30','95.37.132.70','115.74.164.14','213.79.69.42','50.199.202.93','121.96.83.70','85.11.136.237','189.145.163.187','195.252.82.32','92.63.184.133','86.111.116.210','210.186.197.249','176.65.89.55','14.108.83.20','1.186.37.18','1.34.243.180','117.114.147.22','113.23.126.154','201.203.71.194','190.59.10.33','58.54.80.108','171.96.99.56','154.58.205.67','173.196.198.23','109.93.214.181','190.3.197.160','85.96.182.12','124.161.202.114','183.224.48.92','106.75.6.130','190.114.245.85','113.170.124.121','69.156.61.200','118.71.169.168','78.25.93.218','183.68.162.115','88.229.242.249','213.67.253.126','190.59.27.142','117.218.42.156','46.197.224.252','186.78.61.47','14.213.198.21','42.115.14.141','190.159.198.202','85.108.160.129','189.46.160.136','14.158.88.206','116.102.242.78','95.174.115.116','89.216.127.13','190.192.201.58','114.201.226.43','115.79.37.88','101.21.153.18','176.218.154.62','118.41.86.82','110.35.204.252','176.51.42.136','201.177.173.104','42.233.10.56','95.9.179.125','114.33.114.57','123.192.127.42','190.147.211.254','187.175.248.166','121.33.138.234','113.87.178.236','46.197.92.93','37.57.218.2','45.125.63.8','60.54.26.51','14.175.216.95','92.112.23.78','5.2.210.156','85.109.117.42','61.3.88.100','186.47.76.28','78.187.203.83','115.28.59.167','41.253.11.170','103.36.124.123','121.204.241.150','1.174.254.86','82.59.230.118','213.248.173.66','79.130.180.205','120.2.63.231','189.152.147.131','58.127.83.157','95.70.169.5','95.190.88.134','69.70.32.35','178.131.54.56','213.123.207.118','36.234.167.1','118.167.219.8','151.75.105.181','24.190.213.13','182.119.140.33','201.216.173.254','195.208.169.31','193.251.37.56','49.49.153.152','124.234.157.226','58.255.188.21','106.51.43.54','114.75.88.1','112.173.118.226','124.11.128.245','122.100.227.195','177.42.209.114','177.158.172.199','36.228.179.225','180.150.242.170','116.100.228.195','50.255.250.193','179.99.219.155','41.253.88.249','50.242.3.50','189.244.113.37','75.146.52.121','125.89.163.66','59.127.128.205','92.253.178.204','62.162.180.152','59.127.238.28','77.71.2.122','78.132.175.115','123.16.252.231','103.49.55.81','114.25.16.139','37.17.111.135','187.35.95.185','117.207.236.76','27.218.106.70','200.89.50.129','183.7.123.242','84.234.51.42','173.58.228.114','201.80.45.95','176.108.232.207','103.61.66.42','60.246.241.199','221.157.239.167','113.117.226.215','179.104.247.93','181.49.139.59','187.108.114.90','113.104.17.93','135.23.150.168','211.22.207.170','85.133.207.106','182.74.177.138','220.132.249.6','94.177.114.74','190.92.70.102','94.75.38.228','96.80.213.146','113.190.66.245','122.161.125.20','31.155.223.101','117.248.1');

	$gi = geoip_open(realpath("geoloc/GeoLiteCity.dat"),GEOIP_STANDARD);
	
	
	$listeCoord=Array();
	
for($i=0;$i<sizeof($listeIP);$i++)
{
	$cpt=0;
	$IP=$listeIP[$i];
	$record = geoip_record_by_addr($gi,$IP);

	/*echo "<p>------------------------------<br/>";*/
	
	$info=$IP;
	
	if(isset($record->country_name))
		$info=$info."  -  ".$record->country_name;
	if(isset($record->country_code))
	{
		if(isset($GEOIP_REGION_NAME[$record->country_code]))
		{
			if(isset($GEOIP_REGION_NAME[$record->country_code][$record->region]))
				$info=$info."  -  ".$GEOIP_REGION_NAME[$record->country_code][$record->region];
		}
	}
	if(isset($record->city))
		$info=$info."  -  ".$record->city;
	if(isset($record->postal_code))
		$info=$info."  -  ".$record->postal_code;
	if(isset($record->latitude))
		$info=$info."  -  ".$record->latitude;
	if(isset($record->longitude))
		$info=$info."  -  ".$record->longitude;
	
	if(isset($record->latitude))
	{
	$coord=Array($record->latitude,$record->longitude,$info);
	array_push($listeCoord,$coord);
	}
	else
	{$cpt+=1;}
	//echo "</p>";
	
}
geoip_close($gi);




?>

<!DOCTYPE html> 
<html lang="fr"> 
	<head> 
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no"> 
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
		<title>[GoogleMaps API V3] Insertion d'une Carte</title> 
		<style type="text/css"> 
			#div_carte { 
			height : 600px; /* IMPERATIF */ 
			width : 1000px; 
			margin : auto; 
			border : 1px solid #888; 
			} 
		</style> 
		<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script> 
		<script type="text/javascript"> 
function initCarte(){ 
// création de la carte 
var oMap = new google.maps.Map( document.getElementById( 'div_carte'),{ 
'center' : new google.maps.LatLng( 46.80, 1.70), 
'zoom' : 6, 
'mapTypeId' : google.maps.MapTypeId.ROADMAP 
}); 


var image = 'marker.png';

<?php
for($i=0;$i<sizeof($listeCoord);$i++)
	{
	echo "new google.maps.Marker({position: {lat: ".$listeCoord[$i][0]."+Math.random()*0.02-0.01, lng: ".$listeCoord[$i][1]."+Math.random()*0.02-0.01},map: oMap,title:\"".$listeCoord[$i][2]."\",icon:image});\n";//
	//echo "setTimeout('', 50);";
	}
?>

} 
// init lorsque la page est chargée 
google.maps.event.addDomListener( window, 'load', initCarte); 
		</script> 
	</head> 
	<body> 
		<h1>Titre de la carte</h1> 
		
		<p><?php echo $cpt?> adresse(s) n'ont pas pu être localisées.</p>
		
		<div id="div_carte"></div> 
		
		<p>
		<?php
for($i=0;$i<sizeof($listeCoord);$i++)
	
	echo $listeCoord[$i][2]."<br/>";//
	1+1;
?>
		</p>
		
	</body> 
</html>






